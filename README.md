# Project: MOSK
* 코로나19 확진자 동선 알림 앱
* 졸업 작품
* 2020.09 ~ 2021.06

## 0. Goals
- 어떠한 장소에 들어갈 때마다 QR코드를 사용하거나 출입 명부를 작성하는 것이 아닌, 단지 서비스만 실행하여 자동으로 동선을 저장하여 번거로운 출입 절차를 줄이기 위함이다. 
- 공개된 확진자의 동선 정보와 사용자의 위치를 비교하는 기존 앱과 달리 앱 사용자가 확진 판정을 받을 시 해당 앱 사용자의 동선과 확진자의 동선을 비교하여 공개하지 않고도 감염 접촉이 있는 사용자들에게 위험 알림을 주기 위함이다. 
- 출입 명부에 자신의 정보를 작성하지 않아 개인정보 유출 문제를 해결하기 위함이다. 
- 확진자가 발생 시. 바로 자신의 동선과 겹치는지 확인하여 신속하게 자신의 감염 위험 상태를 확인하기 위함이다. 

## 1. Necessity
- 코로나로 인한 감염 발생 시 거치는 역학조사 과정에서 확진자 동선 파악에 어려움이 존재한다. QR코드나 명부를 작성하지 않아 생기는 문제도 존재하며, 확진자가 자신의 이동 경로를 정확하게 기억하는 것은 쉽지 않다.
- 확진자의 이동 경로와 비교하거나 확진자의 동선을 검색하는 것에 어려움을 겪는다. 긴급재난문자로 확진자의 이동 경로를 알려주어도, 정확하게 보지 않고 알림을 꺼버리는 경우가 대부분이다.
- 자신의 이동 경로를 알리고 싶지 않은 사람들 또는 들키고 싶지 않아 거짓말을 하는 사람들로 인해 사회적으로 큰 혼란이 일어나고 있다.
- 확진자의 동선이 공개되면 상가들은 확진자가 다녀간 가게라는 안좋은 인식이 생겨 경제적인 피해를 얻을 수도 있다.
- 출입 명부에 적힌 정보들로 스미싱 문자를 보내는 등 개인정보 유출이 우려되고 있는 상황이다.

## 2. Function
* 사용자 동선 저장
* 확진자 동선 겹침 경고 알림
* 지역별 코로나 거리두기 단계 확인

## 3. Flow
<img src="/doc/imgs/img1.png" width="70%">
<img src="/doc/imgs/img2.png" width="70%">


### Raspberry Pi (Server)
|기능 블록|주요 기능|
|---|---|
|Send TH|- 수신받은 확진자 동선을 모든 Client에게 전송한다. 단, 해당 동선을 보낸 확진자에게는 전송하지 않는다.</br>- DB에 저장된 코로나 확진자 수, 의료기관 등의 정보를 Client에게 전송한다.|
|Recv TH|- 확진자 동선을 수신한다.</br>- 로그인 시 회원정보가 존재하는 지 확인한다.|
|Database(MariaDB)|- 코로나 확진자 수, 의료기관 등의 정보가 저장된 데이터베이스이다.|

### Application (Client)
|기능 블록|주요 기능|
|---|---|
|Background|- 앱을 종료해도 자신의 위치를 저장하고, 확진자 동선을 수신하여 비교할 수 있도록 포그라운드에서 동작한다.|
|Send TH|- 양성 판정을 받은 후 확진자 버튼 클릭 시 자신의 동선을 서버로 전송한다.|
|Recv TH|- 해당 스레드에서는 소켓이 불안정하게 종료될 시(네트워크 변경 등) 주기적으로 서버에 소켓 연결을 요청한다.</br>- 수신받은 확진자 동선을 자신의 동선과 비교한다.</br>- 확진자의 동선과 겹친 시간에 비례하여 확률을 세분화 하여 나타내고, 알림이 다르게 표시된다.|
|Location TH|- 자신의 동선을 저장하는 스레드이다.</br>- 4가지 상태로 표현된다.</br>- Moving : 사용자가 계속해서 이동하고 있는 상태이다.</br>- Detecting Stay : 사용자가 한 장소에 5분이상 머물러있는 상태이다. 해당 위치를 저장 할 준비를 한다.</br>- Staying : 그 장소에 계속해서 머물러있는 상태이다. 이때, 지도에서 자신의 동선을 확인 할 시 ‘동선 저장 중..’ 상태로 표현된다.</br>- Saving Location : 해당 장소를 벗어나게 되면 그 장소의 머물기 시작했던 시간(preTime), 벗어날 때 시간(curTime), 위도(Latitude), 경도(Longitude)를 저장한다.|


## 4. UI
<img src="/doc/imgs/img3.png" width="20%"> <img src="/doc/imgs/img4.png" width="20%"> <img src="/doc/imgs/img5.png" width="20%">
<img src="/doc/imgs/img6.png" width="20%"> <img src="/doc/imgs/img7.png" width="20%"> <img src="/doc/imgs/img8.png" width="20%">
<img src="/doc/imgs/img9.png" width="20%"> <img src="/doc/imgs/img10.png" width="20%"> <img src="/doc/imgs/img11.png" width="20%"> <img src="/doc/imgs/img12.png" width="20%">
